---
title: "TDM_ProjectMEM"
author: "Roger Serra, Yassine Khalili, Kerim Kiliç, Michael Rains"
date: "10/11/2021"
output: 
    prettydoc::html_pretty:
    theme: hpstr
    highlight: github
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(janitor)
library(lubridate)
```

## Introduction

<insert intro here>


The first step is to load the dataset in the system, and check the names of the variables.

```{r}
myData <- read.csv('dataset.csv',sep = ';')

```


### Let's examine the dataset



```{r}
skimr::skim(myData)

glimpse(myData) 

tail(myData)


```

<insert explanation of variables here>




## Cleaning Data

We are going to check if we have loaded all information from the file.



<h2>Run clean data function</h2>



```{r clean_data}



#clean_data <- function (myData) {
  
  ### names of the variables
  myData <- myData %>% clean_names()
  
  ### remove empty rows and columns
  myData <- myData %>% remove_empty(which = c("rows","cols"))
  
  ### remove constant columns
  myData <- myData %>% remove_constant()
  
  ### Check duplicates
  #myData %>% get_dupes(id)
  myData <- myData %>% distinct()
  #myData %>% get_dupes(id)
  #myData <- myData %>% filter (number_days!=63545)
  #myData %>% get_dupes(id)
  
  ### Check n's
  #myData %>% tabyl(gender)
  #myData %>% select (gender) %>% unique () 
  #myData %>% select (gender) %>% unique () %>% count()
  
  ### optional code for changing names of variables in records
  #ifelse (myData$gender == "Female", "female", myData$gender)
  
  ### rounding
  ### Check the rounds of numbers

  # myData$anual_salary
  # myData$anual_salary %>% round() # “banker’s rounding”: halves are rounded to the nearest even number.
  # myData$anual_salary %>% round_half_up()
  
  ### Check the NA

  # myData$Gender <- ifelse (myData$id == "6", "female", myData$Gender)
  # myData$Gender <- ifelse (is.na(myData$Gender), "female", myData$Gender)
  
  myData %>% complete.cases() %>% tabyl
  
  # mydata <- mydata %>% filter(!is.na(anual_salary))
  # mydata <- mydata %>% filter (anual_salary != "NA")
  myData <- myData %>% drop_na()
  # mydata <- mydata %>% drop_na(anual_salary)
  
  
  ### Check the types
  
  myData %>% str()
  # mydata$id <- mydata$id %>% as.integer()
  # mydata
  # mydata$gender <- mydata$gender %>% as.factor()
#}

#  clean_data(myData)

```

Will's last nine vars

```{r}
# get distro function
getDistro <- function(varss) {
  return(myData %>% select(varss) %>% tabyl(varss))
}

dataVars <- names(myData)[1:length(names(myData))]
length(dataVars)

for (vars in dataVars) {
  print(getDistro(vars))
}

```
<br>
From this output we see that we need to clean up **city** variable - we will convert Londres and Barcelone into London and Barcelona respectively.
<br>
```{r,include=FALSE}
myData$city <- ifelse (myData$city == "Barcelone", "Barcelona", myData$city)

myData$city <- ifelse (myData$city == "Londres", "London", myData$city)

myData %>% select(city) %>% tabyl(city)
```

We've now corrected this error. All of the other variables here are just displaying NA's and we will simply filter out NA's when we do any analysis on the different variables.

Some interesting notes we can see is that there is clearly a Barcelona branch and a London branch as well.

Throughout our analysis it will be of value to see if there is a divergence anywhere between branhces for the key metrics.

```{r}
# Cleaning the gender variable
myData$gender <- ifelse(myData$gender == "female", "Female", myData$gender)
myData$gender <- ifelse(myData$gender == "female ", "Female", myData$gender)
myData$gender <- ifelse(myData$gender == "male", "Male", myData$gender)
```

```{r}
# Clean job involvement variable, any job involvement larger than 4 becomes 4
myData$job_involvement <- ifelse(myData$job_involvement>4, 4, myData$job_involvement)
```

```{r}
# Clean marital status data
myData$marital_status <- myData$marital_status <- ifelse(myData$marital_status == "Marrie", "Married", myData$marital_status)
myData$marital_status <- myData$marital_status <- ifelse(myData$marital_status == "Soltero", "Single", myData$marital_status)
```

